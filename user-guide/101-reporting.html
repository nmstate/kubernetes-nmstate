<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Reporting - The Kubernetes NMState project</title>
<meta name="description" content="A declarative API for Kubernetes node network management">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="The Kubernetes NMState project">
<meta property="og:title" content="Reporting">
<meta property="og:url" content="https://nmstate.github.io/kubernetes-nmstate/user-guide/101-reporting.html">


  <meta property="og:description" content="A declarative API for Kubernetes node network management">












<link rel="canonical" href="https://nmstate.github.io/kubernetes-nmstate/user-guide/101-reporting.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "The Kubernetes NMState team",
      "url": "https://nmstate.github.io/kubernetes-nmstate/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/kubernetes-nmstate/feed.xml" type="application/atom+xml" rel="alternate" title="The Kubernetes NMState project Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/kubernetes-nmstate/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/kubernetes-nmstate/"><img src="/kubernetes-nmstate/assets/images/logo/fullcolor.png" alt=""></a>
        
        <a class="site-title" href="/kubernetes-nmstate/">
          The Kubernetes NMState project
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/kubernetes-nmstate/deployment.html">Deployment</a>
            </li>
<li class="masthead__menu-item">
              <a href="/kubernetes-nmstate/user-guide.html">User Guide</a>
            </li>
<li class="masthead__menu-item">
              <a href="/kubernetes-nmstate/examples.html">Examples</a>
            </li>
<li class="masthead__menu-item">
              <a href="https://github.com/nmstate/kubernetes-nmstate">GitHub</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name"></h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox">
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <a href="/kubernetes-nmstate/deployment.html"><span class="nav__sub-title">Deployment</span></a>
        

        
        <ul>
          
            <li><a href="/kubernetes-nmstate/deployment/local-cluster.html">Local cluster</a></li>
          
            <li><a href="/kubernetes-nmstate/deployment/arbitrary-cluster.html">Arbitrary cluster</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <a href="/kubernetes-nmstate/user-guide.html"><span class="nav__sub-title">User Guide</span></a>
        

        
        <ul>
          
            <li><a href="/kubernetes-nmstate/user-guide/101-reporting.html" class="active">Reporting</a></li>
          
            <li><a href="/kubernetes-nmstate/user-guide/102-configuration.html">Configuration</a></li>
          
            <li><a href="/kubernetes-nmstate/user-guide/103-troubleshooting.html">Troubleshooting</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <a href="/kubernetes-nmstate/examples.html"><span class="nav__sub-title">Examples</span></a>
        

        
      </li>
    
      <li>
        
          <a href="https://github.com/nmstate/kubernetes-nmstate"><span class="nav__sub-title">GitHub</span></a>
        

        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Reporting">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Reporting
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>The operator periodically reports state of node network interfaces to the API
server. These reports are available through <code class="language-plaintext highlighter-rouge">NodeNetworkState</code> objects that are
created per each node.</p>

<h2 id="list-all-handled-nodes">List all handled nodes</h2>

<p>List <code class="language-plaintext highlighter-rouge">NodeNetworkStates</code> from all nodes:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get nodenetworkstates
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME     AGE
node01   22s
node02   22s
</code></pre></div></div>

<p>You can also use short name <code class="language-plaintext highlighter-rouge">nns</code> to reach the same effect:</p>

<blockquote>
  <p><strong>Note:</strong> there is a bug in kubectl where <code class="language-plaintext highlighter-rouge">get</code> on short names fails first time it is used.</p>
</blockquote>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get nns
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME     AGE
node01   32s
node02   32s
</code></pre></div></div>

<h2 id="read-state-of-a-specific-node">Read state of a specific node</h2>

<p>By using <code class="language-plaintext highlighter-rouge">-o yaml</code> you obtain the full network state of the given node:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get nns node01 <span class="nt">-o</span> yaml
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">nmstate.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">NodeNetworkState</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">creationTimestamp</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-01-31T12:13:15Z"</span>
  <span class="na">generation</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">node01</span>
  <span class="na">ownerReferences</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Node</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">node01</span>
    <span class="na">uid</span><span class="pi">:</span> <span class="s">5292f6a0-de2d-425c-8c66-ab95fec461e1</span>
  <span class="na">resourceVersion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">946"</span>
  <span class="na">selfLink</span><span class="pi">:</span> <span class="s">/apis/nmstate.io/v1beta1/nodenetworkstates/node01</span>
  <span class="na">uid</span><span class="pi">:</span> <span class="s">aada52e6-f7fa-4bc8-b580-27c2b70f4466</span>
<span class="na">status</span><span class="pi">:</span>
  <span class="na">currentState</span><span class="pi">:</span>
    <span class="na">dns-resolver</span><span class="pi">:</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">search</span><span class="pi">:</span> <span class="pi">[]</span>
        <span class="na">server</span><span class="pi">:</span> <span class="pi">[]</span>
      <span class="na">running</span><span class="pi">:</span>
        <span class="na">search</span><span class="pi">:</span> <span class="pi">[]</span>
        <span class="na">server</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">192.168.66.2</span>
    <span class="na">interfaces</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">bridge</span><span class="pi">:</span>
        <span class="na">options</span><span class="pi">:</span>
          <span class="na">group-forward-mask</span><span class="pi">:</span> <span class="m">0</span>
          <span class="na">mac-ageing-time</span><span class="pi">:</span> <span class="m">300</span>
          <span class="na">multicast-snooping</span><span class="pi">:</span> <span class="no">true</span>
          <span class="na">stp</span><span class="pi">:</span>
            <span class="na">enabled</span><span class="pi">:</span> <span class="no">false</span>
            <span class="na">forward-delay</span><span class="pi">:</span> <span class="m">15</span>
            <span class="na">hello-time</span><span class="pi">:</span> <span class="m">2</span>
            <span class="na">max-age</span><span class="pi">:</span> <span class="m">20</span>
            <span class="na">priority</span><span class="pi">:</span> <span class="m">32768</span>
        <span class="na">port</span><span class="pi">:</span> <span class="pi">[]</span>
      <span class="na">ipv4</span><span class="pi">:</span>
        <span class="na">address</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">ip</span><span class="pi">:</span> <span class="s">10.244.0.1</span>
          <span class="na">prefix-length</span><span class="pi">:</span> <span class="m">24</span>
        <span class="na">dhcp</span><span class="pi">:</span> <span class="no">false</span>
        <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">ipv6</span><span class="pi">:</span>
        <span class="na">address</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">ip</span><span class="pi">:</span> <span class="s">fe80::fc40:9cff:fefa:221a</span>
          <span class="na">prefix-length</span><span class="pi">:</span> <span class="m">64</span>
        <span class="na">autoconf</span><span class="pi">:</span> <span class="no">false</span>
        <span class="na">dhcp</span><span class="pi">:</span> <span class="no">false</span>
        <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">mac-address</span><span class="pi">:</span> <span class="s">FE:40:9C:FA:22:1A</span>
      <span class="na">mtu</span><span class="pi">:</span> <span class="m">1450</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">cni0</span>
      <span class="na">state</span><span class="pi">:</span> <span class="s">up</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">linux-bridge</span>
    <span class="pi">-</span> <span class="na">ipv4</span><span class="pi">:</span>
        <span class="na">address</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">ip</span><span class="pi">:</span> <span class="s">192.168.66.101</span>
          <span class="na">prefix-length</span><span class="pi">:</span> <span class="m">24</span>
        <span class="na">auto-dns</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">auto-gateway</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">auto-routes</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">dhcp</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">ipv6</span><span class="pi">:</span>
        <span class="na">address</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">ip</span><span class="pi">:</span> <span class="s">fe80::5055:ff:fed1:5501</span>
          <span class="na">prefix-length</span><span class="pi">:</span> <span class="m">64</span>
        <span class="na">autoconf</span><span class="pi">:</span> <span class="no">false</span>
        <span class="na">dhcp</span><span class="pi">:</span> <span class="no">false</span>
        <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">mac-address</span><span class="pi">:</span> <span class="s">52:55:00:D1:55:01</span>
      <span class="na">mtu</span><span class="pi">:</span> <span class="m">1500</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">eth0</span>
      <span class="na">state</span><span class="pi">:</span> <span class="s">up</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">ethernet</span>
    <span class="c1"># output truncated</span>
    <span class="na">route-rules</span><span class="pi">:</span>
      <span class="na">config</span><span class="pi">:</span> <span class="pi">[]</span>
    <span class="na">routes</span><span class="pi">:</span>
      <span class="na">config</span><span class="pi">:</span> <span class="pi">[]</span>
      <span class="na">running</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">destination</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
        <span class="na">metric</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">next-hop-address</span><span class="pi">:</span> <span class="s">192.168.66.2</span>
        <span class="na">next-hop-interface</span><span class="pi">:</span> <span class="s">eth0</span>
        <span class="na">table-id</span><span class="pi">:</span> <span class="m">254</span>
      <span class="pi">-</span> <span class="na">destination</span><span class="pi">:</span> <span class="s">192.168.66.0/24</span>
        <span class="na">metric</span><span class="pi">:</span> <span class="m">100</span>
        <span class="na">next-hop-address</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">next-hop-interface</span><span class="pi">:</span> <span class="s">eth0</span>
        <span class="na">table-id</span><span class="pi">:</span> <span class="m">254</span>
      <span class="pi">-</span> <span class="na">destination</span><span class="pi">:</span> <span class="s">ff00::/8</span>
        <span class="na">metric</span><span class="pi">:</span> <span class="m">256</span>
        <span class="na">next-hop-address</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">next-hop-interface</span><span class="pi">:</span> <span class="s">eth0</span>
        <span class="na">table-id</span><span class="pi">:</span> <span class="m">255</span>
      <span class="c1"># output truncated</span>
  <span class="na">lastSuccessfulUpdateTime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-01-31T12:14:00Z"</span>
</code></pre></div></div>

<p>As you can see, the object is cluster-wide (i.e. does not belong to a
namespace). Its <code class="language-plaintext highlighter-rouge">name</code> reflects the name of the Node it represents.</p>

<p>The main part of the object is located in <code class="language-plaintext highlighter-rouge">spec.currentState</code>. It contains the
DNS configuration, list of interfaces observed on the host and their
configuration, and routes.</p>

<!-- TODO: Link API introduction once it is added to docs -->

<p>Last attribute of the object is <code class="language-plaintext highlighter-rouge">lastSuccessfulUpdateTime</code>. It keeps a timestamp
recording the last successful update of the report. Since the report is updated
periodically and won’t get updated while the node is not reachable (e.g. during
reconfiguration of networking), this value can be used to evaluate whether the
observed state is fresh enough.</p>

<h2 id="configure-refresh-interval">Configure refresh interval</h2>

<p>The reported state is updated every 5 seconds.</p>

<h2 id="node-network-state-interfaces-filtering">Node Network State interfaces filtering</h2>

<p>All unmanaged <code class="language-plaintext highlighter-rouge">veth</code> interfaces are omitted from the report in order to not
clutter the output with all Pod connections.</p>

<h2 id="continue-reading">Continue reading</h2>

<p>The following tutorial will guide you through the configuration of node
networking: <a href="/kubernetes-nmstate/user-guide/102-configuration.html">Configuration</a></p>

        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/nmstate/kubernetes-nmstate" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/kubernetes-nmstate/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2021 The Kubernetes NMState team. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/kubernetes-nmstate/assets/js/main.min.js"></script>










  </body>
</html>
